{
  "permissions": {
    "allow": [
      "Bash(git fetch --all --prune)",
      "Bash(powershell -ExecutionPolicy Bypass -File .specify/scripts/powershell/create-new-feature.ps1 -Json -Number 1 -ShortName \"textbook-physical-ai\" -FeatureDescription \"Create a technical textbook titled \"\"Physical AI & Humanoid Robotics\"\".\n\nPurpose:\nThis book teaches students how artificial intelligence operates in the physical world through humanoid robotics.\n\nAudience:\nUniversity students and professionals with basic AI and Python knowledge.\n\nBook Structure:\n- Introduction to Physical AI and Embodied Intelligence\n- ROS 2 fundamentals for humanoid robots\n- Robot simulation using Gazebo and Unity\n- NVIDIA Isaac Sim and Isaac ROS\n- Vision-Language-Action systems\n- Conversational humanoid robots\n- Capstone: Autonomous simulated humanoid robot\n\nRequirements:\n- Written as a Docusaurus documentation book\n- Each chapter should include explanations, examples, and learning outcomes\n- Use markdown files organized by chapters\n- No chatbot or RAG functionality in this phase\n- Content must align with the provided course outline\")",
      "Bash(powershell -ExecutionPolicy Bypass -File .specify/scripts/powershell/setup-plan.ps1 -Json)",
      "Bash(powershell -ExecutionPolicy Bypass -File .specify/scripts/powershell/update-agent-context.ps1 -AgentType claude)",
      "Bash(powershell -ExecutionPolicy Bypass -File .specify/scripts/powersaurus/check-prerequisites.ps1 -Json)",
      "Bash(powershell -ExecutionPolicy Bypass -File .specify/scripts/powershell/check-prerequisites.ps1 -Json)",
      "Bash(powershell -ExecutionPolicy Bypass -File .specify/scripts/powershell/check-prerequisites.ps1 -Json -RequireTasks -IncludeTasks)",
      "Bash(git rev-parse --git-dir)",
      "Bash(if test -d \"E:\\\\Python VSCode\\\\Hakathon\\\\GIAIC Hakathon\\\\physical-ai-book\\\\specs\\\\001-textbook-physical-ai\\\\checklists\")",
      "Bash(then echo \"Checklists directory exists\")",
      "Bash(else echo \"No checklists directory found\")",
      "Bash(fi)",
      "Bash(dir \"E:\\\\Python VSCode\\\\Hakathon\\\\GIAIC Hakathon\\\\physical-ai-book\\\\specs\\\\001-textbook-physical-ai\\\\checklists\" /B)",
      "Bash(if test -d \"E:\\\\Python VSCode\\\\Hakathon\\\\GIAIC Hakathon\\\\physical-ai-book\\\\specs\\\\001-textbook-physical-ai\\\\contracts\")",
      "Bash(then echo \"Contracts directory exists\")",
      "Bash(else echo \"No contracts directory found\")",
      "Bash(dir \"E:\\\\Python VSCode\\\\Hakathon\\\\GIAIC Hakathon\\\\physical-ai-book\\\\specs\\\\001-textbook-physical-ai\\\\contracts\" /B)",
      "Bash(if [ -f \".gitignore\" ])",
      "Bash(then echo \"gitignore exists\")",
      "Bash(else echo \"gitignore does not exist\")",
      "Bash(if [ -f \"package.json\" ])",
      "Bash(then echo \"package.json exists, checking for other config files\")",
      "Bash(else echo \"no package.json\")",
      "Bash(ls -la docs/chapter-*/*.md)",
      "Bash(npm run build)",
      "Bash(findstr /n \"<60\")",
      "Bash(ls -la docs/tutorial*)",
      "Bash(npm run serve)",
      "Skill(sp.phr)",
      "Bash(powershell -ExecutionPolicy Bypass -File .specify/scripts/powershell/create-new-feature.ps1 -Json -Number 1 -ShortName \"rag-chatbot\" -FeatureDescription \"Add an embedded RAG chatbot to the Physical AI book.\n\nCapabilities:\n- Answer questions using the book content\n- Only respond based on indexed book text\n- Allow user to ask questions from selected text\n- Embedded chat UI inside Docusaurus pages\n\nTechnical Constraints:\n- Backend using FastAPI\n- Use OpenAI Agents / ChatKit SDK\n- Vector database: Qdrant Cloud free tier\n- Metadata storage: Neon Serverless Postgres\n- Frontend integration via REST API\n\nNon-goals:\n- No authentication in this phase\n- No personalization\")",
      "Bash(if test -d \"E:\\\\Python VSCode\\\\Hakathon\\\\GIAIC Hakathon\\\\physical-ai-book\\\\specs\\\\001-rag-chatbot\\\\checklists\")",
      "Bash(dir \"E:\\\\Python VSCode\\\\Hakathon\\\\GIAIC Hakathon\\\\physical-ai-book\\\\specs\\\\001-rag-chatbot\\\\checklists\" /B)",
      "Bash(if [ -d \".git\" ])",
      "Bash(then echo \"Git repo exists\")",
      "Bash(else echo \"No git repo found\")",
      "Bash(else echo \"no gitignore\")",
      "Bash(if [ -f \"README.md\" ])",
      "Bash(then echo \"README exists\")",
      "Bash(else echo \"No README\")",
      "Bash(if [ -f \"backend/requirements.txt\" ])",
      "Bash(then echo \"Found backend requirements.txt\")",
      "Bash(else echo \"No backend requirements.txt\")",
      "Bash(python -m src.utils.indexer)",
      "Bash(pip install -r requirements.txt)",
      "Bash(curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs)",
      "Bash(sh -s -- -y)",
      "Bash(python -m pip install --upgrade pip)",
      "Bash(pip install fastapi==0.104.1 uvicorn[standard]==0.24.0 python-dotenv==1.0.0 openai==1.3.7)",
      "Bash(pip install qdrant-client==1.8.0)",
      "Bash(pip install asyncpg)",
      "Bash(pip install qdrant-client[fastembed])",
      "Bash(pip install aiosqlite)",
      "Bash(timeout 60s python -m src.utils.indexer)",
      "Bash(timeout 120s python -m src.utils.indexer)",
      "Bash(timeout 30s python -c \"import asyncio; from src.utils.indexer import DocumentIndexer; async def test\\(\\): indexer = DocumentIndexer\\(\\); await indexer.initialize_services\\(\\); print\\(''Services initialized''\\); await test\\(\\)\")",
      "Bash(python test_services.py)",
      "Bash(python -c \"import asyncio; from src.utils.indexer import DocumentIndexer; async def test_services\\(\\): print\\(''Initializing indexer...''\\); indexer = DocumentIndexer\\(\\); print\\(''Indexer created, initializing services...''\\); await indexer.initialize_services\\(\\); print\\(''Services initialized successfully!''\\); asyncio.run\\(test_services\\(\\)\\)\")",
      "Bash(timeout 10s python test_services.py)",
      "Bash(python test_indexing.py)",
      "Bash(timeout 30s python test_indexing.py)",
      "Bash(python -c \"import sys; sys.path.insert\\(0, ''backend/src''\\); import asyncio; from backend.src.utils.indexer import DocumentIndexer; async def test\\(\\): indexer = DocumentIndexer\\(\\); await indexer.initialize_services\\(\\); print\\(''Services OK''\\); await test\\(\\)\")",
      "Bash(python test_indexing_root.py)",
      "Bash(timeout 60s python test_indexing_root.py)",
      "Bash(timeout 120s python run_indexer.py)",
      "Bash(timeout 180s python run_indexer.py)",
      "Bash(python run_indexer.py)",
      "Bash(echo \"import pytest\nimport asyncio\nfrom fastapi.testclient import TestClient\nfrom src.api.main import app\nfrom src.services.rag_service import RAGService\nfrom unittest.mock import AsyncMock, patch\n\n\n@pytest.fixture\ndef client\\(\\):\n    \"\"\"\"\"\"Create a test client for the FastAPI app\"\"\"\"\"\"\n    return TestClient\\(app\\)\n\n\n@pytest.mark.asyncio\nasync def test_chat_endpoint_contract\\(\\):\n    \"\"\"\"\"\"Test the contract for the POST /chat endpoint\"\"\"\"\"\"\n    client = TestClient\\(app\\)\n\n    # Mock the RAG service to avoid actual API calls during testing\n    with patch\\(''src.api.chat.rag_service''\\) as mock_rag_service:\n        # Setup mock response\n        mock_rag_service.get_answer.return_value = {\n            \"\"answer\"\": \"\"This is a test response based on book content.\"\",\n            \"\"sources\"\": [\n                {\n                    \"\"document_id\"\": \"\"test-doc-1\"\",\n                    \"\"title\"\": \"\"Test Document\"\",\n                    \"\"path\"\": \"\"test-document.md\"\",\n                    \"\"relevance_score\"\": 0.85\n                }\n            ],\n            \"\"confidence\"\": 0.92\n        }\n\n        # Test request data matching the contract\n        request_data = {\n            \"\"question\"\": \"\"What is a ROS 2 node?\"\",\n            \"\"page_context\"\": \"\"chapter-3-ros-fundamentals.md\"\",\n            \"\"selected_text\"\": \"\"A ROS 2 node is a process that performs computation.\"\",\n            \"\"session_id\"\": \"\"test-session-id\"\"\n        }\n\n        # Make the request\n        response = client.post\\(\"\"/chat\"\", json=request_data\\)\n\n        # Verify response structure and status\n        assert response.status_code == 200\n\n        # Parse response\n        data = response.json\\(\\)\n\n        # Verify response structure matches contract\n        assert \"\"id\"\" in data\n        assert \"\"question_id\"\" in data\n        assert \"\"answer\"\" in data\n        assert \"\"sources\"\" in data\n        assert \"\"confidence\"\" in data\n        assert \"\"session_id\"\" in data\n        assert \"\"timestamp\"\" in data\n\n        # Verify data types and content\n        assert isinstance\\(data[\"\"id\"\"], str\\)\n        assert isinstance\\(data[\"\"question_id\"\"], str\\)\n        assert isinstance\\(data[\"\"answer\"\"], str\\)\n        assert isinstance\\(data[\"\"sources\"\"], list\\)\n        assert isinstance\\(data[\"\"confidence\"\"], \\(int, float\\)\\)\n        assert isinstance\\(data[\"\"session_id\"\"], str\\)\n        assert isinstance\\(data[\"\"timestamp\"\"], str\\)  # ISO format timestamp\n\n        # Verify sources structure\n        if data[\"\"sources\"\"]:\n            source = data[\"\"sources\"\"][0]\n            assert \"\"document_id\"\" in source\n            assert \"\"title\"\" in source\n            assert \"\"path\"\" in source\n            assert \"\"relevance_score\"\" in source\n\n\n@pytest.mark.asyncio\nasync def test_chat_endpoint_validation\\(\\):\n    \"\"\"\"\"\"Test validation of the POST /chat endpoint\"\"\"\"\"\"\n    client = TestClient\\(app\\)\n\n    # Test with invalid request format\n    invalid_request = {\n        \"\"invalid_field\"\": \"\"invalid_value\"\"\n    }\n\n    response = client.post\\(\"\"/chat\"\", json=invalid_request\\)\n\n    # Should return 400 for invalid request\n    assert response.status_code in [400, 422]  # 422 is also valid for validation errors\n\n\n@pytest.mark.asyncio\nasync def test_chat_endpoint_missing_fields\\(\\):\n    \"\"\"\"\"\"Test the endpoint with missing required fields\"\"\"\"\"\"\n    client = TestClient\\(app\\)\n\n    # Test with minimal required fields\n    minimal_request = {\n        \"\"question\"\": \"\"What is this?\"\",\n        \"\"session_id\"\": \"\"test-session-id\"\"\n    }\n\n    with patch\\(''src.api.chat.rag_service''\\) as mock_rag_service:\n        mock_rag_service.get_answer.return_value = {\n            \"\"answer\"\": \"\"Test response\"\",\n            \"\"sources\"\": [],\n            \"\"confidence\"\": 0.8\n        }\n\n        response = client.post\\(\"\"/chat\"\", json=minimal_request\\)\n\n        # Should succeed with minimal valid request\n        assert response.status_code == 200\n\n\ndef test_chat_endpoint_method\\(\\):\n    \"\"\"\"\"\"Test that the endpoint only accepts POST requests\"\"\"\"\"\"\n    client = TestClient\\(app\\)\n\n    # Test GET method \\(should not be allowed\\)\n    response = client.get\\(\"\"/chat\"\"\\)\n    assert response.status_code in [405, 404]  # Method not allowed or not found\")",
      "Bash(python validate_implementation.py)",
      "Skill(sp.git.commit_pr)",
      "Bash(git add .)"
    ]
  }
}
